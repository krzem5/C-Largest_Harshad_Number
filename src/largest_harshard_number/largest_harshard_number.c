#include <stdint.h>



static const uint64_t _remainder_table[241]={0,0,
	0x8000000000000000ull,0x5555555555555556ull,0x4000000000000000ull,0x3333333333333334ull,
	0x2aaaaaaaaaaaaaabull,0x2492492492492493ull,0x2000000000000000ull,0x1c71c71c71c71c72ull,
	0x199999999999999aull,0x1745d1745d1745d2ull,0x1555555555555556ull,0x13b13b13b13b13b2ull,
	0x124924924924924aull,0x1111111111111112ull,0x1000000000000000ull,0x0f0f0f0f0f0f0f10ull,
	0x0e38e38e38e38e39ull,0x0d79435e50d79436ull,0x0ccccccccccccccdull,0x0c30c30c30c30c31ull,
	0x0ba2e8ba2e8ba2e9ull,0x0b21642c8590b217ull,0x0aaaaaaaaaaaaaabull,0x0a3d70a3d70a3d71ull,
	0x09d89d89d89d89d9ull,0x097b425ed097b426ull,0x0924924924924925ull,0x08d3dcb08d3dcb09ull,
	0x0888888888888889ull,0x0842108421084211ull,0x0800000000000000ull,0x07c1f07c1f07c1f1ull,
	0x0787878787878788ull,0x0750750750750751ull,0x071c71c71c71c71dull,0x06eb3e45306eb3e5ull,
	0x06bca1af286bca1bull,0x0690690690690691ull,0x0666666666666667ull,0x063e7063e7063e71ull,
	0x0618618618618619ull,0x05f417d05f417d06ull,0x05d1745d1745d175ull,0x05b05b05b05b05b1ull,
	0x0590b21642c8590cull,0x0572620ae4c415caull,0x0555555555555556ull,0x05397829cbc14e5full,
	0x051eb851eb851eb9ull,0x0505050505050506ull,0x04ec4ec4ec4ec4edull,0x04d4873ecade304eull,
	0x04bda12f684bda13ull,0x04a7904a7904a791ull,0x0492492492492493ull,0x047dc11f7047dc12ull,
	0x0469ee58469ee585ull,0x0456c797dd49c342ull,0x0444444444444445ull,0x04325c53ef368eb1ull,
	0x0421084210842109ull,0x0410410410410411ull,0x0400000000000000ull,0x03f03f03f03f03f1ull,
	0x03e0f83e0f83e0f9ull,0x03d226357e16ece6ull,0x03c3c3c3c3c3c3c4ull,0x03b5cc0ed7303b5dull,
	0x03a83a83a83a83a9ull,0x039b0ad12073615bull,0x038e38e38e38e38full,0x0381c0e070381c0full,
	0x03759f22983759f3ull,0x0369d0369d0369d1ull,0x035e50d79435e50eull,0x03531dec0d4c77b1ull,
	0x0348348348348349ull,0x033d91d2a2067b24ull,0x0333333333333334ull,0x0329161f9add3c0dull,
	0x031f3831f3831f39ull,0x03159721ed7e7535ull,0x030c30c30c30c30dull,0x0303030303030304ull,
	0x02fa0be82fa0be83ull,0x02f149902f149903ull,0x02e8ba2e8ba2e8bbull,0x02e05c0b81702e06ull,
	0x02d82d82d82d82d9ull,0x02d02d02d02d02d1ull,0x02c8590b21642c86ull,0x02c0b02c0b02c0b1ull,
	0x02b9310572620ae5ull,0x02b1da46102b1da5ull,0x02aaaaaaaaaaaaabull,0x02a3a0fd5c5f02a4ull,
	0x029cbc14e5e0a730ull,0x0295fad40a57eb51ull,0x028f5c28f5c28f5dull,0x0288df0cac5b3f5eull,
	0x0282828282828283ull,0x027c45979c952050ull,0x0276276276276277ull,0x0270270270270271ull,
	0x026a439f656f1827ull,0x02647c69456217edull,0x025ed097b425ed0aull,0x02593f69b02593f7ull,
	0x0253c8253c8253c9ull,0x024e6a171024e6a2ull,0x024924924924924aull,0x0243f6f0243f6f03ull,
	0x023ee08fb823ee09ull,0x0239e0d5b450239full,0x0234f72c234f72c3ull,0x0230230230230231ull,
	0x022b63cbeea4e1a1ull,0x0226b90226b90227ull,0x0222222222222223ull,0x021d9ead7cd391fcull,
	0x02192e29f79b4759ull,0x0214d0214d0214d1ull,0x0210842108421085ull,0x020c49ba5e353f7dull,
	0x0208208208208209ull,0x0204081020408103ull,0x0200000000000000ull,0x01fc07f01fc07f02ull,
	0x01f81f81f81f81f9ull,0x01f44659e4a42716ull,0x01f07c1f07c1f07dull,0x01ecc07b301ecc08ull,
	0x01e9131abf0b7673ull,0x01e573ac901e573bull,0x01e1e1e1e1e1e1e2ull,0x01de5d6e3f8868a5ull,
	0x01dae6076b981dafull,0x01d77b654b82c33aull,0x01d41d41d41d41d5ull,0x01d0cb58f6ec0744ull,
	0x01cd85689039b0aeull,0x01ca4b3055ee1911ull,0x01c71c71c71c71c8ull,0x01c3f8f01c3f8f02ull,
	0x01c0e070381c0e08ull,0x01bdd2b899406f75ull,0x01bacf914c1bacfaull,0x01b7d6c3dda338b3ull,
	0x01b4e81b4e81b4e9ull,0x01b2036406c80d91ull,0x01af286bca1af287ull,0x01ac5701ac5701adull,
	0x01a98ef606a63bd9ull,0x01a6d01a6d01a6d1ull,0x01a41a41a41a41a5ull,0x01a16d3f97a4b01bull,
	0x019ec8e951033d92ull,0x019c2d14ee4a101aull,0x019999999999999aull,0x01970e4f80cb8728ull,
	0x01948b0fcd6e9e07ull,0x01920fb49d0e228eull,0x018f9c18f9c18f9dull,0x018d3018d3018d31ull,
	0x018acb90f6bf3a9bull,0x01886e5f0abb049aull,0x0186186186186187ull,0x0183c977ab2bedd3ull,
	0x0181818181818182ull,0x017f405fd017f406ull,0x017d05f417d05f42ull,0x017ad2208e0ecc36ull,
	0x0178a4c8178a4c82ull,0x01767dce434a9b11ull,0x01745d1745d1745eull,0x01724287f46debc1ull,
	0x01702e05c0b81703ull,0x016e1f76b4337c6dull,0x016c16c16c16c16dull,0x016a13cd15372905ull,
	0x0168168168168169ull,0x01661ec6a5122f91ull,0x01642c8590b21643ull,0x01623fa7701623fbull,
	0x0160581605816059ull,0x015e75bb8d015e76ull,0x015c9882b9310573ull,0x015ac056b015ac06ull,
	0x0158ed2308158ed3ull,0x01571ed3c506b39bull,0x0155555555555556ull,0x015390948f40feadull,
	0x0151d07eae2f8152ull,0x0150150150150151ull,0x014e5e0a72f05398ull,0x014cab88725af6e8ull,
	0x014afd6a052bf5a9ull,0x0149539e3b2d066full,0x0147ae147ae147afull,0x01460cbc7f5cf9a2ull,
	0x01446f86562d9fafull,0x0142d6625d51f86full,0x0141414141414142ull,0x013fb013fb013fb1ull,
	0x013e22cbce4a9028ull,0x013c995a47babe75ull,0x013b13b13b13b13cull,0x013991c2c187f634ull,
	0x0138138138138139ull,0x013698df3de0747aull,0x013521cfb2b78c14ull,0x0133ae45b57bcb1full,
	0x01323e34a2b10bf7ull,0x0130d190130d1902ull,0x012f684bda12f685ull,0x012e025c04b80971ull,
	0x012c9fb4d812c9fcull,0x012b404ad012b405ull,0x0129e4129e4129e5ull,0x01288b01288b0129ull,
	0x0127350b88127351ull,0x0125e22708092f12ull,0x0124924924924925ull,0x0123456789abcdf1ull,
	0x0121fb78121fb782ull,0x0120b470c67c0d89ull,0x011f7047dc11f705ull,0x011e2ef3b3fb8745ull,
	0x011cf06ada2811d0ull,0x011bb4a4046ed291ull,0x011a7b9611a7b962ull,0x0119453808ca29c1ull,
	0x0118118118118119ull,0x0116e0689427378full,0x0115b1e5f75270d1ull,0x011485f0e0acd3b7ull,
	0x01135c81135c8114ull,0x0112358e75d30337ull,0x0111111111111112ull
};



static inline _Bool _is_harshard_number(uint64_t x){
	uint64_t y=(x&0x0f0f0f0f0f0f0f0full)+((x>>4)&0x0f0f0f0f0f0f0f0full);
	y=(y&0x00ff00ff00ff00ffull)+((y>>8)&0x00ff00ff00ff00ffull);
	y=(y&0x000000ff000000ffull)+((y>>16)&0x000000ff000000ffull);
	y=(y&0x00000000000000ffull)+((y>>32)&0x00000000000000ffull);
	uint64_t z=_remainder_table[y];
	return (x*z<z&&y!=1);
}



uint64_t largest_harshard_number(uint64_t from,uint64_t to){
	if (from<2){
		from=2;
	}
	if (to<from){
		to=from+1;
	}
	uint64_t out=0;
	while (from<to){
		if (_is_harshard_number(from)){
			out=from;
		}
		from++;
	}
	return out;
}
